"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[404],{6404:function(e,a,t){t.r(a),t.d(a,{default:function(){return K}});t(4114);var o=t(6768),n=t(4232),s=t(7007),l=t(144),c=t(4373),i=t(876);const r={class:"container"},u={class:"row content"},m={key:0},d={key:1},k={class:"col-md-12"},p={class:"write-button-container fixed-button-container mt-3 mx-4"},v={xmlns:"http://www.w3.org/2000/svg",width:"35",height:"35",fill:"currentColor",class:"bi bi-plus-circle me-2",viewBox:"0 0 16 16",style:{"margin-left":"-12px","margin-top":"-5px"}},g={class:"scrollable-content"},y={class:"community-item"},h={class:"d-flex align-items-center"},w={class:"text-muted mt-4",id:"userNickName"},f={class:"image-map-container mb-2"},C=["src","onClick"],b={class:"date-overlay",id:"communityRegDate"},L=["id","onClick"],N={class:"d-flex justify-content-between align-items-center ms-2",id:"my-container"},E={class:"d-flex align-items-center"},x=["onClick"],M={class:"like-count ms-1"},A={class:"comment-count ms-2"},P={class:"d-flex ms-2"},I={class:"text-muted me-2",id:"userNickName"},R={class:"card-text",id:"cardContent"};var _={__name:"CommunityView",setup(e){const a=(0,l.KR)([]),t=(0,l.KR)({}),_=(0,l.KR)(""),D=(0,l.KR)({}),X=(0,l.KR)([]),K=(0,l.KR)(!1),O=(0,l.KR)("photo"),B=async()=>{try{await J(),K.value=!1,await(0,o.dY)(),a.value.forEach((e=>{q(e.courseName,e.communityPk,e.lat,e.lng)}))}catch(e){console.error(e)}},$=async()=>{try{const e=await c.A.post("/api/safeList");a.value=e.data.map((e=>({...e,showMap:!0,likes:e.likes||0,commentCount:e.commentCount||0,courseName:e.courseName,lat:e.lat||e.latitude,lng:e.lng||e.longitude}))),await(0,o.dY)(),a.value.forEach((e=>{q(e.courseName,e.communityPk,e.lat,e.lng)})),K.value=!0}catch(e){console.error("Error during safe list loading:",e)}},j=(0,o.EW)((()=>a.value.filter((e=>e.communityBody.includes(_.value)||e.userNickName.includes(_.value))))),S=()=>{i.A.push({path:"/writePost"})},V=e=>{i.A.push({path:"/communityDetailView",query:{community:JSON.stringify(e)}})};function Y(e,a,o){const n=document.getElementById(e);if(!n)return void console.error(`Element with ID ${e} not found`);const s={center:new kakao.maps.LatLng(a,o),level:6},l=new kakao.maps.Map(n,s);return t.value[e]=l,l}const F=async e=>{try{const a=await c.A.post("/api/course/byName",{courseName:e});X.value=a.data,i.A.push({name:"mobilemountaindetailview",query:{course:JSON.stringify(X.value),mapType:O.value}})}catch(a){console.error("Error during like or navigation:",a)}},T=async()=>{try{const e=await c.A.get("/data/인왕산ele copy.geojson"),a=e.data;a.features.forEach((e=>{const a=e.properties.PMNTN_NM,t=e.geometry.coordinates.reduce(((e,a)=>e.concat(a.map((e=>({lat:e[1],lng:e[0]}))))),[]);D.value[a]||(D.value[a]=[]),D.value[a].push(...t)})),console.log("Course Data Loaded:",D.value)}catch(e){console.error("GeoJSON 데이터를 불러오는 중 오류 발생:",e)}},q=(e,a,o,n)=>{const s=`map-${a}`;z(s);const l=Object.keys(D.value).find((a=>a.includes(e)));if(!l)return void console.error(`Coordinates not found for course: ${e}`);const c=D.value[l],i=c.map((e=>new kakao.maps.LatLng(e.lat,e.lng)));let r=t.value[s];if(r||(r=Y(s,o,n)),r){const e=new kakao.maps.Polyline({path:i,strokeWeight:5,strokeColor:"#00FF00",strokeOpacity:.8,strokeStyle:"solid"});e.setMap(r),console.log(`Polyline set for course: ${l}`,e.getPath())}else console.error(`Map not found for map ID: ${s}`)};function z(e){const a=t.value[e];a&&(a.removeOverlayMapTypeId(kakao.maps.MapTypeId.POLYLINE),t.value[e]=null)}(0,o.sV)((async()=>{const e=document.createElement("script");e.onload=async()=>{kakao.maps.load((async()=>{await T(),await J(),await(0,o.dY)(),a.value.forEach((e=>{q(e.courseName,e.communityPk,e.lat,e.lng)}))}))},e.src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=333bda7da18df138fb4d9b3e5cf351c4&autoload=false",document.head.appendChild(e)}));const J=async()=>{try{const e=await c.A.get("/api/communityList");a.value=e.data.map((e=>({...e,showMap:!0,likes:e.likes||0,commentCount:e.commentCount||0,courseName:e.courseName,lat:e.lat||e.latitude,lng:e.lng||e.longitude}))),j.value=a.value,a.value.sort(((e,a)=>new Date(a.communityRegDate)-new Date(e.communityRegDate))),await(0,o.dY)(),a.value.forEach((e=>{const a=`map-${e.communityPk}`;Y(a,e.lat,e.lng)})),console.log(a.value)}catch(e){console.error(e)}},U=async e=>{try{const t=localStorage.getItem("userId");if(!t)return void console.log("User not logged in");const o=await c.A.post("/api/like",{userId:t,communityPk:e});a.value=o.data.map((e=>({...e,showMap:!0,likes:e.likes||0,commentCount:e.commentCount||0,lat:e.lat||e.latitude,lng:e.lng||e.longitude})))}catch(t){console.log("Error liking the post:",t)}};return(e,t)=>((0,o.uX)(),(0,o.CE)("div",r,[(0,o.bF)(s.A,{class:"header"}),(0,o.Lk)("div",u,[K.value?((0,o.uX)(),(0,o.CE)("div",m,[(0,o.Lk)("button",{class:"btn btn-success btn-sm mb-3 mt-3 ms-3",onClick:t[0]||(t[0]=e=>B())},"모든 게시물 보기")])):((0,o.uX)(),(0,o.CE)("div",d,[(0,o.Lk)("button",{class:"btn btn-success btn-sm mb-3 mt-3 ms-3",onClick:t[1]||(t[1]=e=>$())},"안전 게시물 보기")])),(0,o.Lk)("div",k,[(0,o.Lk)("div",p,[(0,o.Lk)("button",{class:"btn btn-lg custom-btn2",onClick:t[2]||(t[2]=e=>S())},[((0,o.uX)(),(0,o.CE)("svg",v,t[3]||(t[3]=[(0,o.Lk)("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"},null,-1),(0,o.Lk)("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"},null,-1)])))])]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.value,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.communityPk,class:"card shadow-sm"},[(0,o.Lk)("div",g,[(0,o.Lk)("div",y,[(0,o.Lk)("div",h,[t[4]||(t[4]=(0,o.Lk)("img",{src:"/images/profile.png",alt:"프로필 사진",class:"profile-image me-2"},null,-1)),(0,o.Lk)("p",w,(0,n.v_)(e.userNickName),1)]),(0,o.Lk)("div",f,[e.communityUrl?((0,o.uX)(),(0,o.CE)("img",{key:0,src:e.communityUrl,alt:"게시글 이미지",class:"img-fluid",style:{width:"500px",height:"225px","object-fit":"cover"},onClick:a=>V(e)},null,8,C)):(0,o.Q3)("",!0),(0,o.Lk)("div",b,(0,n.v_)(e.communityRegDate),1),e.showMap?((0,o.uX)(),(0,o.CE)("div",{key:1,id:"map-"+e.communityPk,class:"map-overlay",onClick:a=>F(e.courseName),style:{cursor:"pointer"}},null,8,L)):(0,o.Q3)("",!0)]),(0,o.Lk)("div",N,[(0,o.Lk)("div",E,[((0,o.uX)(),(0,o.CE)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"19",height:"19",fill:"currentColor",class:(0,n.C4)(["bi bi-heart like-icon",{liked:e.liked}]),onClick:a=>U(e.communityPk),viewBox:"0 0 16 16"},[(0,o.Lk)("path",{d:"m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 \r\n                      6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 \r\n                      2.01zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143q.09.083.176.171a3 3 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15",class:(0,n.C4)({"text-danger":e.liked})},null,2)],10,x)),(0,o.Lk)("span",M,(0,n.v_)(e.likes),1),t[5]||(t[5]=(0,o.Lk)("span",{class:"comment-icon ms-2"},[(0,o.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"19",height:"19",fill:"currentColor",class:"bi bi-chat-left-dots",viewBox:"0 0 16 16"},[(0,o.Lk)("path",{d:"M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H4.414A2 2 0 0 0 3 11.586l-2 2V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12.793a.5.5 0 0 0 .854.353l2.853-2.853A1 1 0 0 1 4.414 12H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),(0,o.Lk)("path",{d:"M5 6a1 1 0 1 1-2 0 1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0"})])],-1)),(0,o.Lk)("span",A,(0,n.v_)(e.commentCount),1)])]),(0,o.Lk)("div",P,[(0,o.Lk)("span",I,(0,n.v_)(e.userNickName),1),(0,o.Lk)("span",R,(0,n.v_)(e.communityBody),1)])])])])))),128))])])]))}},D=t(1241);const X=(0,D.A)(_,[["__scopeId","data-v-558bbfc2"]]);var K=X}}]);
//# sourceMappingURL=404.497ca8ae.js.map