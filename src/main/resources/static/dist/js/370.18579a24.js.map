{"version":3,"file":"js/370.18579a24.js","mappings":"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","sources":["webpack://frontend/./src/views/MobileCoursePreview.vue","webpack://frontend/./src/views/MobileCoursePreview.vue?b410"],"sourcesContent":["<template>\r\n  <div class=\"course-preview-page\">\r\n    <button @click=\"goBack\" class=\"back-button\"><img src=\"/images/뒤로가기.png\"  alt=\"뒤로가기\" ></button>\r\n\r\n    <div class=\"video-container\">\r\n      <video\r\n        ref=\"videoRef\"\r\n        controls\r\n        autoplay\r\n        muted\r\n        @timeupdate=\"syncCourseWithVideo\"\r\n        class=\"video-player\"\r\n      >\r\n        <source :src=\"courseData.courseVideo\" type=\"video/mp4\" />\r\n        브라우저가 비디오 태그를 지원하지 않습니다.\r\n      </video>\r\n\r\n      <!-- 작은 지도를 클릭하면 크기 변경 -->\r\n      <div\r\n        id=\"smallMap\"\r\n        :class=\"['small-map', { 'expanded-map': isMapExpanded }]\"\r\n        @click=\"toggleMapSize\"\r\n      ></div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, nextTick } from 'vue';\r\nimport { useRoute, useRouter } from 'vue-router';\r\n\r\n/* global kakao */\r\nconst route = useRoute();\r\nconst router = useRouter();\r\nconst courseData = ref(JSON.parse(route.query.course));\r\nconst videoRef = ref(null);\r\nconst smallMap = ref(null);\r\nconst routeCoordinates = ref([]);\r\nconst currentMarker = ref(null);\r\nconst isMapExpanded = ref(false);\r\n\r\nconst goBack = () => router.back();\r\n\r\n// Kakao Maps API\r\nfunction loadKakaoMapScript() {\r\n  return new Promise((resolve, reject) => {\r\n    if (window.kakao && window.kakao.maps) {\r\n      resolve();\r\n    } else {\r\n      const script = document.createElement('script');\r\n      script.onload = () => kakao.maps.load(resolve);\r\n      script.onerror = reject;\r\n      script.src = 'https://dapi.kakao.com/v2/maps/sdk.js?appkey=333bda7da18df138fb4d9b3e5cf351c4&autoload=false';\r\n      document.head.appendChild(script);\r\n    }\r\n  });\r\n}\r\n\r\n// 작은 지도 초기화 (경로 추가)\r\nasync function initializeSmallMap() {\r\n  await nextTick();\r\n\r\n  const smallMapElement = document.getElementById('smallMap');\r\n  if (!smallMapElement) {\r\n    console.error(\"smallMap 요소를 찾을 수 없습니다.\");\r\n    return;\r\n  }\r\n\r\n  smallMap.value = new kakao.maps.Map(smallMapElement, {\r\n    center: new kakao.maps.LatLng(37.66433293993584, 127.01160029114365),\r\n    level: 5,\r\n  });\r\n\r\n  const geoJsonPath = `/data/인왕산ele copy.geojson`;\r\n  await loadGeoJSONFromServer(geoJsonPath, smallMap.value);\r\n}\r\n\r\n// 경로 데이터 로드\r\nasync function loadGeoJSONFromServer(url, targetMap) {\r\n  try {\r\n    const response = await fetch(url);\r\n    const geojsonData = await response.json();\r\n\r\n    let linePath = [];\r\n    let isCourseFound = false;\r\n\r\n    geojsonData.features.forEach(feature => {\r\n      if (feature.properties.PMNTN_NM.includes(courseData.value.courseName)) {\r\n        isCourseFound = true;\r\n        if (feature.geometry.type === 'MultiLineString') {\r\n          feature.geometry.coordinates.forEach(line => {\r\n            line.forEach(coord => {\r\n              const latLng = new kakao.maps.LatLng(coord[1], coord[0]);\r\n              linePath.push(latLng);\r\n              routeCoordinates.value.push({ lat: coord[1], lng: coord[0], elevation: feature.properties.DN || 0 });\r\n            });\r\n          });\r\n        } else if (feature.geometry.type === 'LineString') {\r\n          feature.geometry.coordinates.forEach(coord => {\r\n            const latLng = new kakao.maps.LatLng(coord[1], coord[0]);\r\n            linePath.push(latLng);\r\n            routeCoordinates.value.push({ lat: coord[1], lng: coord[0], elevation: feature.properties.DN || 0 });\r\n          });\r\n        }\r\n      }\r\n    });\r\n\r\n    if (isCourseFound && linePath.length > 0) {\r\n      const polyline = new kakao.maps.Polyline({\r\n        path: linePath,\r\n        strokeWeight: 5,\r\n        strokeColor: '#FF0000',\r\n        strokeOpacity: 0.8,\r\n      });\r\n      polyline.setMap(targetMap);\r\n\r\n      const bounds = new kakao.maps.LatLngBounds();\r\n      linePath.forEach(coord => bounds.extend(coord));\r\n      \r\n      targetMap.setBounds(bounds);\r\n      targetMap.setLevel(targetMap.getLevel() - 2);\r\n    } else {\r\n      console.warn(\"일치하는 코스가 없거나 유효한 좌표가 없습니다.\");\r\n    }\r\n  } catch (error) {\r\n    console.error('GeoJSON 파일 로드 중 에러 발생:', error);\r\n  }\r\n}\r\n\r\n// 비디오 시간과 경로 동기화\r\nfunction syncCourseWithVideo(event) {\r\n  if (!smallMap.value || !routeCoordinates.value.length) return;\r\n\r\n  const currentTime = event.target.currentTime;\r\n  const totalDuration = event.target.duration;\r\n  const progress = currentTime / totalDuration;\r\n  const currentRouteIndex = Math.floor(progress * routeCoordinates.value.length);\r\n  highlightRouteOnMap(currentRouteIndex);\r\n}\r\n\r\n// 특정 경로 지점 강조\r\nfunction highlightRouteOnMap(index) {\r\n  if (index >= 0 && index < routeCoordinates.value.length && smallMap.value) {\r\n    const point = routeCoordinates.value[index];\r\n\r\n    if (currentMarker.value) {\r\n      currentMarker.value.setMap(null);\r\n    }\r\n\r\n    currentMarker.value = new kakao.maps.Marker({\r\n      position: new kakao.maps.LatLng(point.lat, point.lng),\r\n      map: smallMap.value,\r\n    });\r\n\r\n    smallMap.value.panTo(new kakao.maps.LatLng(point.lat, point.lng));\r\n  }\r\n}\r\n\r\n// 지도의 확대/축소 상태를 토글\r\nfunction toggleMapSize() {\r\n  isMapExpanded.value = !isMapExpanded.value;\r\n\r\n  if (isMapExpanded.value && routeCoordinates.value.length > 0) {\r\n    const middleIndex = Math.floor(routeCoordinates.value.length / 2);\r\n    const middlePoint = routeCoordinates.value[middleIndex];\r\n    \r\n    if (middlePoint) {\r\n      smallMap.value.setCenter(new kakao.maps.LatLng(middlePoint.lat, middlePoint.lng));\r\n      smallMap.value.setLevel(3); // 확대할 때 레벨을 낮춤 (1~3은 좀 더 확대)\r\n    }\r\n  } else {\r\n    smallMap.value.setLevel(5); // 축소할 때 원래 레벨\r\n  }\r\n}\r\n\r\n// 페이지 로드 시 비디오 자동 재생 및 지도 초기화\r\nonMounted(async () => {\r\n  await loadKakaoMapScript();\r\n  await initializeSmallMap();\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n.course-preview-page {\r\n  position: relative;\r\n  display: flex;\r\n  flex-direction: column;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n}\r\n\r\n.back-button {\r\n  position: absolute;\r\n  top: 20px;\r\n  left: 20px;\r\n  background-color: #ffffff;\r\n  color: rgb(12, 12, 12);\r\n  border: none;\r\n  border-radius: 50%;\r\n  width: 40px;\r\n  height: 40px;\r\n  z-index: 10;\r\n  cursor: pointer;\r\n}\r\n\r\n#back-button:hover {\r\n  transform: scale(1.1); \r\n  background-color: rgba(255, 255, 255, 1); \r\n}\r\n\r\n#back-button img {\r\n  width: 20px;\r\n  height: 20px;\r\n}\r\n\r\n.video-container {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.video-player {\r\n  width: 100%;\r\n  height: 100vh;\r\n  object-fit: cover;\r\n}\r\n\r\n.small-map {\r\n  position: absolute;\r\n  top: 20px;\r\n  right: 20px;\r\n  width: 100px;\r\n  height: 100px;\r\n  border: 2px solid #ffffff;\r\n  border-radius: 10px;\r\n  box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.3);\r\n  z-index: 10;\r\n  transition: width 0.3s ease, height 0.3s ease;\r\n  cursor: pointer;\r\n}\r\n\r\n.small-map.expanded-map {\r\n  width: 200px;\r\n  height: 200px;\r\n}\r\n</style>\r\n","import script from \"./MobileCoursePreview.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./MobileCoursePreview.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./MobileCoursePreview.vue?vue&type=style&index=0&id=194d385e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-194d385e\"]])\n\nexport default __exports__"],"names":["route","useRoute","router","useRouter","courseData","ref","JSON","parse","query","course","videoRef","smallMap","routeCoordinates","currentMarker","isMapExpanded","goBack","back","loadKakaoMapScript","Promise","resolve","reject","window","kakao","maps","script","document","createElement","onload","load","onerror","src","head","appendChild","async","initializeSmallMap","nextTick","smallMapElement","getElementById","console","error","value","Map","center","LatLng","level","geoJsonPath","loadGeoJSONFromServer","url","targetMap","response","fetch","geojsonData","json","linePath","isCourseFound","features","forEach","feature","properties","PMNTN_NM","includes","courseName","geometry","type","coordinates","line","coord","latLng","push","lat","lng","elevation","DN","length","polyline","Polyline","path","strokeWeight","strokeColor","strokeOpacity","setMap","bounds","LatLngBounds","extend","setBounds","setLevel","getLevel","warn","syncCourseWithVideo","event","currentTime","target","totalDuration","duration","progress","currentRouteIndex","Math","floor","highlightRouteOnMap","index","point","Marker","position","map","panTo","toggleMapSize","middleIndex","middlePoint","setCenter","onMounted","__exports__"],"sourceRoot":""}