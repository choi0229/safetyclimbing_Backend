"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[338],{1338:function(t,a,e){e.r(a),e.d(a,{default:function(){return k}});var n=e(6768),o=e(5130),c=e(4232),s=e(7007),r=e(144),d=e(6886),l=e.n(d),i=(e(954),e(5710),e(6912));const u={class:"dashboard"},h={class:"sidebar"},m={class:"stat-section"},p={class:"search"},v={class:"chart-section"},b={class:"main"};var y={__name:"AccidentView",setup(t){delete l().Icon.Default.prototype._getIconUrl,l().Icon.Default.mergeOptions({iconRetinaUrl:e(8249),iconUrl:e(7024),shadowUrl:e(1071)}),i.t1.register(...i.$L);const a=(0,r.KR)(null),d=(0,r.KR)([]),y=(0,r.KR)([]),f=(0,r.KR)("");let g=null,k=null,C=null,L=null,_=null;function w(){g=l().map(a.value).setView([37.658955,126.977834],8),l().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19}).addTo(g)}async function E(){try{const t=await fetch("/data/2023산악사고 copy.geojson"),a=await t.json();d.value=a.features.map((t=>({latitude:t.geometry.coordinates[1],longitude:t.geometry.coordinates[0],mountainName:t.properties.acdnt_place_nm||"알 수 없음",countAccident:0,accidentType:t.properties.acdnt_cause_asort_nm||"알 수 없음",month:t.properties.dclr_mnth||0,season:t.properties.season_se_nm||"알 수 없음"}))),A(),x()}catch(t){console.error("사고 데이터 로드 오류:",t)}}function A(){_&&g.removeLayer(_);const t=d.value.map((t=>[t.latitude,t.longitude,.5]));_=l().heatLayer(t,{radius:25,blur:15,maxZoom:17}).addTo(g)}function x(){const t=l().markerClusterGroup();d.value.forEach((a=>{const e=l().marker([a.latitude,a.longitude]);e.bindPopup(`\n        <b>사고 위치:</b> ${a.mountainName}<br>\n        <b>사고 유형:</b> ${a.accidentType}\n      `),t.addLayer(e)})),g.addLayer(t)}function F(){const t={};d.value.forEach((a=>{const e=a.mountainName||"알 수 없음";t[e]=(t[e]||0)+1})),y.value=Object.entries(t).map((([t,a])=>({mountainName:t,countAccident:a}))).sort(((t,a)=>a.countAccident-t.countAccident)).slice(0,3)}function I(){j(),T(),K()}function j(){const t={};d.value.forEach((a=>{t[a.accidentType]=(t[a.accidentType]||0)+1}));const a=document.getElementById("doughnutChart").getContext("2d");C&&C.destroy(),C=new i.t1(a,{type:"doughnut",data:{labels:Object.keys(t),datasets:[{data:Object.values(t),backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0"]}]}})}function T(){const t=Array(12).fill(0);d.value.forEach((a=>{a.month>0&&t[a.month-1]++}));const a=document.getElementById("monthlyChart").getContext("2d");k&&k.destroy(),k=new i.t1(a,{type:"bar",data:{labels:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],datasets:[{label:"월별 사고",data:t,backgroundColor:"rgba(75, 192, 192, 0.6)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1}]},options:{scales:{y:{beginAtZero:!0}}}})}function K(){const t={"봄":0,"여름":0,"가을":0,"겨울":0};d.value.forEach((a=>{void 0!==t[a.season]&&t[a.season]++}));const a=document.getElementById("statsChart").getContext("2d");L&&L.destroy(),L=new i.t1(a,{type:"bar",data:{labels:Object.keys(t),datasets:[{label:"계절별 사고",data:Object.values(t),backgroundColor:"rgba(153, 102, 255, 0.6)",borderColor:"rgba(153, 102, 255, 1)",borderWidth:1}]},options:{scales:{y:{beginAtZero:!0}}}})}return(0,n.sV)((async()=>{try{w(),await E(),await F(),I()}catch(t){console.error("초기화 오류:",t)}})),(t,e)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(s.A,{style:{"z-index":"4",width:"1920px"}}),(0,n.Lk)("div",u,[(0,n.Lk)("aside",h,[(0,n.Lk)("section",m,[(0,n.Lk)("div",p,[(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>f.value=t),placeholder:"산 검색"},null,512),[[o.Jo,f.value]]),(0,n.Lk)("img",{id:"search-img",src:"https://s3.ap-northeast-2.amazonaws.com/cdn.wecode.co.kr/icon/search.png",onClick:e[1]||(e[1]=(...a)=>t.searchPlaces&&t.searchPlaces(...a))})])]),(0,n.Lk)("section",v,[e[2]||(e[2]=(0,n.Lk)("h2",null,"2024 산악사고 Top3",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(y.value,((t,a)=>((0,n.uX)(),(0,n.CE)("div",{key:a},[(0,n.Lk)("p",null,(0,c.v_)(a+1)+": "+(0,c.v_)(t.mountainName)+" ("+(0,c.v_)(t.countAccident)+"건)",1)])))),128))]),e[3]||(e[3]=(0,n.Lk)("div",{class:"chart1-section"},[(0,n.Lk)("h2",null,"산악 사고 유형"),(0,n.Lk)("canvas",{id:"doughnutChart"})],-1))]),(0,n.Lk)("main",b,[(0,n.Lk)("div",{id:"map",ref_key:"mapContainer",ref:a},null,512),e[4]||(e[4]=(0,n.Fv)('<div id="grapth" data-v-486c37af><section class="bottomchart-section" data-v-486c37af><h2 id="monthly_stat" data-v-486c37af>월별 사고 통계</h2><canvas id="monthlyChart" data-v-486c37af></canvas></section><div class="bottomchart-section" data-v-486c37af><h2 data-v-486c37af>계절별 사고</h2><canvas id="statsChart" data-v-486c37af></canvas></div></div>',1))])])],64))}},f=e(1241);const g=(0,f.A)(y,[["__scopeId","data-v-486c37af"]]);var k=g}}]);
//# sourceMappingURL=338.17c716f7.js.map