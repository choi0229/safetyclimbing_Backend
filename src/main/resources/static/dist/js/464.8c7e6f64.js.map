{"version":3,"file":"js/464.8c7e6f64.js","mappings":"4gBAgEA,IAAIA,EAASC,aAAaC,QAAQ,UAC9BC,EAAeF,aAAaC,QAAQ,gBACxC,MAAME,GAASC,EAAAA,EAAAA,MAETC,GAAQC,EAAAA,EAAAA,IAAI,IACZC,GAAUD,EAAAA,EAAAA,IAAI,IACdE,GAAaF,EAAAA,EAAAA,IAAI,IAGjBG,GAAWH,EAAAA,EAAAA,KAAI,GACrB,IAAII,EAAgB,EAGpB,MAAMC,GAASL,EAAAA,EAAAA,KAAI,GACnB,IAAIM,EAAc,EAEdC,EAAgB,EAChBC,EAAiB,EAEjBC,GAAmBT,EAAAA,EAAAA,KAAI,GAGvBU,EAAS,KAEb,MAAMC,GAAeX,EAAAA,EAAAA,IAAI,MAEnBY,EAAiBC,IACrBF,EAAaG,MAAQD,EAAME,OAAOC,MAAM,EAAE,EAGtCC,EAAcC,UAClB,IAAKP,EAAaG,MAChB,OAAO,KAET,MAAMK,EAAW,IAAIC,SACrBD,EAASE,OAAO,OAAQV,EAAaG,OAErC,IACE,MAAMQ,QAAiBC,EAAAA,EAAMC,KAAK,wBAAyBL,EAAU,CACnEM,QAAS,CACP,eAAgB,yBAGpB,OAAOH,EAASI,IAClB,CAAE,MAAOC,GAEP,OADAC,QAAQD,MAAM,wBAAyBA,GAChC,IACT,GAGIE,EAAaX,UAGjB,IAAKzB,EAGH,OAFAmC,QAAQD,MAAM,qBACdG,MAAM,8BAKN1B,EADoB,GAAlBD,EAASW,MACK,EAEA,EAIhBR,EADkB,GAAhBD,EAAOS,MACK,EAEA,EAIhB,MAAMiB,QAAkBd,IAClBe,EAAW,CACfC,eAAgBlC,EAAMe,MACtBoB,cAAejC,EAAQa,MACvBqB,aAAcJ,EACdnC,aAAcA,EACdH,OAAQA,EACR2C,UAAW5B,EACX6B,SAAU9B,EACV+B,YAAalC,EACbmC,UAAWjC,EACXJ,WAAYA,EAAWY,OAGzB,UACQS,EAAAA,EAAMC,KAAK,qBAAsBQ,EAAU,CAC/CP,QAAS,CACP,eAAgB,sBAGpB5B,EAAO2C,KAAK,mBACd,CAAE,MAAOb,GACPC,QAAQD,MAAM,aAAcA,GAC5BG,MAAM,6BACR,GAIF,SAASW,IACP,MAAMC,EAASC,SAASC,cAAc,UACtCF,EAAOG,OAAS,KACdC,MAAMC,KAAKC,MAAK,KACdC,IACAxC,EAAiBK,OAAQ,CAAI,GAC7B,EAEJ4B,EAAOQ,IAAM,kHACbP,SAASQ,KAAKC,YAAYV,EAC5B,CAEA,IAAIW,EAEJ,SAASJ,IACP,MAAMK,EAAeX,SAASY,eAAe,OACvCC,EAAY,CAChBC,OAAQ,IAAIX,MAAMC,KAAKW,OAAO,eAAoB,mBAClDC,MAAO,GAITN,EAAM,IAAIP,MAAMC,KAAKa,IAAIN,EAAcE,GAGvC9C,EAAS,IAAIoC,MAAMC,KAAKc,OAAO,CAC7BC,SAAUT,EAAIU,cAEhBrD,EAAOsD,OAAOX,GAEdP,MAAMC,KAAKlC,MAAMoD,YAAYZ,EAAK,SAAS,SAAUa,GACnD,MAAMC,EAASD,EAAWE,OAE1B1D,EAAO2D,YAAYF,GACnB5D,EAAgB4D,EAAOG,SACvB9D,EAAiB2D,EAAOI,SACxB5B,SAASY,eAAe,eAAeiB,UAAY,OAAOL,EAAOG,iBAAiBH,EAAOI,UAC3F,GACF,EAIAE,EAAAA,EAAAA,KAAU,KACRhC,GAAe,IAGjB,MAAMiC,EAASA,KACb7E,EAAO2C,KAAK,CAAEmC,KAAM,mBAAoB,E,k6EC7M1C,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://frontend/./src/views/WritePostView.vue","webpack://frontend/./src/views/WritePostView.vue?55d3"],"sourcesContent":["<template>\r\n  <div style=\"text-align: left;\">\r\n    <button class=\"back-button ms-2 btn btn-success btn-sm mb-3 mt-3 ms-3 mx-2 custom-btn\" @click=\"goBack\">뒤로가기</button>\r\n  </div>\r\n  <div class=\"container\">\r\n    <div class=\"d-flex justify-content-center\">\r\n      <h2>게시글 작성</h2>\r\n    </div>\r\n    <!-- 공개 여부 체크박스 -->\r\n    <div class=\"form-check form-switch d-flex justify-content-end\">\r\n      <input class=\"form-check-input\" type=\"checkbox\" role=\"switch\" id=\"flexSwitchCheckDefaultPublic\"\r\n        v-model=\"isPublic\">\r\n      <label class=\"form-check-label ms-2\" for=\"flexSwitchCheckDefaultPublic\">공개 여부</label>\r\n    </div>\r\n\r\n    <!-- 안전 여부 체크박스 -->\r\n    <div class=\"form-check form-switch d-flex justify-content-end\">\r\n      <input class=\"form-check-input\" type=\"checkbox\" role=\"switch\" id=\"flexSwitchCheckDefaultSafe\" v-model=\"isSafe\">\r\n      <label class=\"form-check-label ms-2\" for=\"flexSwitchCheckDefaultSafe\">안전 게시글</label>\r\n    </div>\r\n\r\n    <div class=\"mb-3\">\r\n      <div class=\"text-start\">\r\n        <label for=\"title\" class=\"form-label\">제목</label>\r\n      </div>\r\n\r\n      <input type=\"text\" id=\"title\" v-model=\"title\" class=\"form-control\" required />\r\n    </div>\r\n\r\n    <div class=\"mb-2\">\r\n      <div id=\"map\" class=\"map-container\"></div>\r\n      <div class=\"d-flex justify-content-center\">\r\n        <p style=\"margin: 0;\"><em>지도를 클릭해주세요!</em></p>\r\n      </div>\r\n      <div id=\"clickLatlng\"></div>\r\n    </div>\r\n\r\n    <div class=\"mb-3\">\r\n      <div class=\"text-start\">\r\n        <label for=\"courseName\" class=\"form-label\">코스 이름</label>\r\n      </div>\r\n      <input type=\"text\" id=\"courseName\" v-model=\"courseName\" class=\"form-control\" required />\r\n    </div>\r\n\r\n    <div class=\"mb-3 text-start\">\r\n      <label for=\"content\" class=\"form-label\">내용</label>\r\n      <textarea id=\"content\" v-model=\"content\" class=\"form-control\" rows=\"5\" required></textarea>\r\n    </div>\r\n\r\n    <div class=\"d-flex flex-column mb-3 fv-row text-start\">\r\n      <label for=\"image\" class=\"form-label\">이미지 첨부</label>\r\n      <input type=\"file\" id=\"image\" class=\"form-control\" @change=\"onImageChange\" ref=\"image\" accept=\"image/*\" />\r\n    </div>\r\n\r\n    <button type=\"submit\" class=\"btn btn-success\" @click=\"submitPost()\">작성하기</button>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n/* global kakao */\r\nimport { ref, onMounted } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\nimport axios from 'axios';\r\n\r\nlet userId = localStorage.getItem('userId');\r\nlet userNickName = localStorage.getItem('userNickName');\r\nconst router = useRouter();\r\n\r\nconst title = ref('');\r\nconst content = ref('');\r\nconst courseName = ref('');\r\n\r\n// 공개 여부\r\nconst isPublic = ref(true); // 초기값을 false로 설정\r\nlet isPublicState = 0;\r\n\r\n// 안전 여부\r\nconst isSafe = ref(true);\r\nlet isSafeState = 0;\r\n\r\nlet latitudeInput = 0;\r\nlet longitudeInput = 0;\r\n// Kakao Maps가 로드된 상태를 추적하는 변수\r\nlet isKakaoMapLoaded = ref(false);\r\n\r\n// 마커 변수 추가\r\nlet marker = null;\r\n\r\nconst selectedFile = ref(null);\r\n\r\nconst onImageChange = (event) => {\r\n  selectedFile.value = event.target.files[0];\r\n};\r\n\r\nconst uploadImage = async () => {\r\n  if (!selectedFile.value) {\r\n    return null;\r\n  }\r\n  const formData = new FormData();\r\n  formData.append('file', selectedFile.value);\r\n\r\n  try {\r\n    const response = await axios.post('/api/community/upload', formData, {\r\n      headers: {\r\n        'Content-Type': 'multipart/form-data',\r\n      },\r\n    });\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Error uploading image', error);\r\n    return null;\r\n  }\r\n};\r\n\r\nconst submitPost = async () => {\r\n\r\n\r\n  if (!userId) {\r\n    console.error('유저 정보가 없습니다.');\r\n    alert('로그인 정보가 없습니다. 다시 로그인 해주세요.');\r\n    return;\r\n  }\r\n\r\n  if (isPublic.value == true) {\r\n    isPublicState = 1;\r\n  } else {\r\n    isPublicState = 0;\r\n  }\r\n\r\n  if (isSafe.value == true) {\r\n    isSafeState = 1;\r\n  } else {\r\n    isSafeState = 0;\r\n  }\r\n\r\n\r\n  const imagePath = await uploadImage();\r\n  const postData = {\r\n    communityTitle: title.value,\r\n    communityBody: content.value,\r\n    communityUrl: imagePath, // 이미지 URL로 설정\r\n    userNickName: userNickName, // userId가 객체로 변환됨\r\n    userId: userId,\r\n    longitude: longitudeInput,\r\n    latitude: latitudeInput,\r\n    publicState: isPublicState,\r\n    safeState: isSafeState,\r\n    courseName: courseName.value\r\n  };\r\n\r\n  try {\r\n    await axios.post('/api/community/add', postData, {\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    });\r\n    router.push('/mobilecommunity'); // Redirect here\r\n  } catch (error) {\r\n    console.error('게시글 작성 실패:', error);\r\n    alert('게시글 작성에 실패했습니다. 다시 시도해주세요.');\r\n  }\r\n};\r\n\r\n\r\nfunction initializeMap() {\r\n  const script = document.createElement('script');\r\n  script.onload = () => {\r\n    kakao.maps.load(() => {\r\n      createMap();\r\n      isKakaoMapLoaded.value = true; // Kakao Maps 로드 완료\r\n    });\r\n  };\r\n  script.src = 'https://dapi.kakao.com/v2/maps/sdk.js?appkey=333bda7da18df138fb4d9b3e5cf351c4&autoload=false&libraries=services';\r\n  document.head.appendChild(script);\r\n}\r\n\r\nlet map; // 전역으로 맵 객체를 선언합니다\r\n\r\nfunction createMap() {\r\n  const mapContainer = document.getElementById(\"map\");\r\n  const mapOption = {\r\n    center: new kakao.maps.LatLng(37.578633866659999, 126.959531894056894),\r\n    level: 4,\r\n  };\r\n\r\n  // 맵 객체를 생성하고 전역 변수에 할당합니다.\r\n  map = new kakao.maps.Map(mapContainer, mapOption);\r\n\r\n  // 마커 초기화\r\n  marker = new kakao.maps.Marker({\r\n    position: map.getCenter(),\r\n  });\r\n  marker.setMap(map);\r\n\r\n  kakao.maps.event.addListener(map, \"click\", function (mouseEvent) {\r\n    const latlng = mouseEvent.latLng;\r\n    // 클릭한 위치에 마커를 이동\r\n    marker.setPosition(latlng);\r\n    latitudeInput = latlng.getLat();\r\n    longitudeInput = latlng.getLng();\r\n    document.getElementById(\"clickLatlng\").innerHTML = `위도: ${latlng.getLat()}, 경도: ${latlng.getLng()}`;\r\n  });\r\n}\r\n\r\n\r\n\r\nonMounted(() => {\r\n  initializeMap();\r\n})\r\n\r\nconst goBack = () => {\r\n  router.push({ name: 'mobilecommunity' });\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* 폰트-face 정의 */\r\n@font-face {\r\n  font-family: 'TheJamsil5Bold';\r\n  src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_2302_01@1.0/TheJamsil5Bold.woff2') format('woff2');\r\n  font-weight: 500;\r\n  font-style: normal;\r\n}\r\n\r\n/* 전체 텍스트 폰트 적용 */\r\nbody,\r\nh1,\r\nh2,\r\nh3,\r\np,\r\nlabel,\r\n.form-label,\r\n.form-control,\r\n.form-check-label,\r\n.btn,\r\ntextarea,\r\ninput {\r\n  font-family: 'TheJamsil5Bold', sans-serif !important;\r\n}\r\n\r\n/* 제목 */\r\nh2 {\r\n  font-weight: bold;\r\n}\r\n\r\n/* 뒤로가기 버튼 */\r\nbutton.back-button {\r\n  font-family: 'TheJamsil5Bold', sans-serif !important;\r\n  font-weight: bold;\r\n  font-size: 16px;\r\n  padding: 10px 20px;\r\n  border-radius: 5px;\r\n  background-color: #4CAF50;\r\n  color: white;\r\n  border: none;\r\n  cursor: pointer;\r\n}\r\n\r\nbutton.back-button:hover {\r\n  background-color: #4CAF50;\r\n}\r\n\r\n/* 공개 여부 체크박스 레이블 */\r\n.form-check-label {\r\n  font-family: 'TheJamsil5Bold', sans-serif !important;\r\n}\r\n\r\n/* 텍스트 입력 필드 */\r\n.form-control {\r\n  font-family: 'TheJamsil5Bold', sans-serif !important;\r\n  font-size: 14px;\r\n}\r\n\r\n/* 텍스트 영역 */\r\ntextarea.form-control {\r\n  font-family: 'TheJamsil5Bold', sans-serif !important;\r\n  font-size: 14px;\r\n}\r\n\r\n/* 제출 버튼 */\r\nbutton[type=\"submit\"] {\r\n  font-family: 'TheJamsil5Bold', sans-serif !important;\r\n  font-weight: bold;\r\n  font-size: 16px;\r\n  background-color: #4CAF50;\r\n  color: white;\r\n  padding: 10px 20px;\r\n  border-radius: 5px;\r\n  border: none;\r\n  cursor: pointer;\r\n}\r\n\r\nbutton[type=\"submit\"]:hover {\r\n  background-color: #45a049;\r\n}\r\n\r\n/* 지도 영역 */\r\n.map-container {\r\n  width: 100%;\r\n  height: 150px;\r\n}\r\n\r\n/* 좌표 표시 */\r\n#clickLatlng {\r\n  font-size: 12px;\r\n  color: #555;\r\n}\r\n\r\n/* 폼 컨테이너 스타일 */\r\n.container {\r\n  font-family: 'TheJamsil5Bold', sans-serif !important;\r\n  padding: 20px;\r\n}\r\n\r\n/* 폼 레이블 */\r\n.form-label {\r\n  font-family: 'TheJamsil5Bold', sans-serif !important;\r\n}\r\n\r\n/* 체크박스 및 스위치 */\r\n.form-check-input {\r\n  font-family: 'TheJamsil5Bold', sans-serif !important;\r\n}\r\n</style>","import script from \"./WritePostView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./WritePostView.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./WritePostView.vue?vue&type=style&index=0&id=2ece6335&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2ece6335\"]])\n\nexport default __exports__"],"names":["userId","localStorage","getItem","userNickName","router","useRouter","title","ref","content","courseName","isPublic","isPublicState","isSafe","isSafeState","latitudeInput","longitudeInput","isKakaoMapLoaded","marker","selectedFile","onImageChange","event","value","target","files","uploadImage","async","formData","FormData","append","response","axios","post","headers","data","error","console","submitPost","alert","imagePath","postData","communityTitle","communityBody","communityUrl","longitude","latitude","publicState","safeState","push","initializeMap","script","document","createElement","onload","kakao","maps","load","createMap","src","head","appendChild","map","mapContainer","getElementById","mapOption","center","LatLng","level","Map","Marker","position","getCenter","setMap","addListener","mouseEvent","latlng","latLng","setPosition","getLat","getLng","innerHTML","onMounted","goBack","name","__exports__"],"sourceRoot":""}